import React from 'react';
import { cn } from '@/lib/utils';
import { Button } from './button';
import { ScrollArea } from './scroll-area';
import { SidebarNavLinks } from './sidebar/SidebarNavLinks';
import {
  Sheet,
  SheetContent,
  SheetHeader,
  SheetTitle,
} from './sheet';
import { SidebarHeader } from './sidebar/SidebarHeader';
import { sidebarVariants } from './sidebar/theme/sidebarTheme';
import { useSidebarTheme } from './sidebar/theme/SidebarThemeContext';

interface AppSidebarProps {
  className?: string;
  isExpanded: boolean;
  onToggle: () => void;
}

export function AppSidebar({ className, isExpanded, onToggle }: AppSidebarProps) {
  const [isMobileOpen, setIsMobileOpen] = React.useState(false);
  const { theme } = useSidebarTheme();

  return (
    <>
      {/* Desktop Sidebar */}
      <aside className={cn(
        sidebarVariants({ 
          theme: theme, 
          size: isExpanded ? "expanded" : "collapsed" 
        }),
        className
      )}>
        <SidebarHeader
          isExpanded={isExpanded}
          onToggle={onToggle}
        />
        <ScrollArea className="flex-1 overflow-y-auto">
          <SidebarNavLinks isExpanded={isExpanded} />
        </ScrollArea>
      </aside>

      {/* Mobile Sidebar */}
      <Sheet open={isMobileOpen} onOpenChange={setIsMobileOpen}>
        <SheetContent side="left" className="w-[280px] p-0">
          <SheetHeader className="h-16 bg-black border-b px-4 flex items-center">
            <SheetTitle className="flex items-center gap-2">
              <svg width="146" height="39" viewBox="0 0 146 39" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M47.0619 11.5556V14.6062H42.6939V27.7333H39.5046V14.6062H35.1597V11.5556H47.0619Z" fill="#384161" />
                <path d="M50.218 18.1653C50.4954 17.4258 50.9499 16.8711 51.5816 16.5013C52.2287 16.1316 52.9451 15.9467 53.7309 15.9467V19.2747C52.8219 19.1668 52.0053 19.3517 51.2811 19.8293C50.5724 20.307 50.218 21.1004 50.218 22.2098V27.7333H47.2367V16.1778H50.218V18.1653Z" fill="#384161" />
                <path d="M63.8279 16.1778H66.8093V27.7333H63.8279V26.3698C62.9343 27.4945 61.6786 28.0569 60.0608 28.0569C58.5201 28.0569 57.1951 27.4714 56.0857 26.3004C54.9918 25.1141 54.4448 23.6658 54.4448 21.9556C54.4448 20.2453 54.9918 18.8047 56.0857 17.6338C57.1951 16.4474 58.5201 15.8542 60.0608 15.8542C61.6786 15.8542 62.9343 16.4166 63.8279 17.5413V16.1778ZM58.3275 24.3129C58.9284 24.9138 59.6911 25.2142 60.6155 25.2142C61.5399 25.2142 62.3026 24.9138 62.9035 24.3129C63.5198 23.6966 63.8279 22.9108 63.8279 21.9556C63.8279 21.0003 63.5198 20.2222 62.9035 19.6213C62.3026 19.005 61.5399 18.6969 60.6155 18.6969C59.6911 18.6969 58.9284 19.005 58.3275 19.6213C57.7266 20.2222 57.4262 21.0003 57.4262 21.9556C57.4262 22.9108 57.7266 23.6966 58.3275 24.3129Z" fill="#384161" />
                <path d="M78.2719 11.5556H81.2532V27.7333H78.2719V26.3698C77.3936 27.4945 76.1456 28.0569 74.5279 28.0569C72.9717 28.0569 71.639 27.4714 70.5296 26.3004C69.4357 25.1141 68.8887 23.6658 68.8887 21.9556C68.8887 20.2453 69.4357 18.8047 70.5296 17.6338C71.639 16.4474 72.9717 15.8542 74.5279 15.8542C76.1456 15.8542 77.3936 16.4166 78.2719 17.5413V11.5556ZM72.7714 24.3129C73.3877 24.9138 74.1581 25.2142 75.0825 25.2142C76.007 25.2142 76.7696 24.9138 77.3705 24.3129C77.9714 23.6966 78.2719 22.9108 78.2719 21.9556C78.2719 21.0003 77.9714 20.2222 77.3705 19.6213C76.7696 19.005 76.007 18.6969 75.0825 18.6969C74.1581 18.6969 73.3877 19.005 72.7714 19.6213C72.1705 20.2222 71.8701 21.0003 71.8701 21.9556C71.8701 22.9108 72.1705 23.6966 72.7714 24.3129Z" fill="#384161" />
                <path d="M86.4989 23.1804C86.8995 24.6287 87.9857 25.3529 89.7575 25.3529C90.8977 25.3529 91.7605 24.9677 92.346 24.1973L94.7495 25.584C93.6094 27.2326 91.93 28.0569 89.7113 28.0569C87.8008 28.0569 86.2678 27.4791 85.1122 26.3236C83.9566 25.168 83.3789 23.712 83.3789 21.9556C83.3789 20.2145 83.9489 18.7662 85.0891 17.6107C86.2292 16.4397 87.6929 15.8542 89.4802 15.8542C91.175 15.8542 92.5694 16.4397 93.6633 17.6107C94.7726 18.7816 95.3273 20.2299 95.3273 21.9556C95.3273 22.3407 95.2888 22.749 95.2118 23.1804H86.4989ZM86.4526 20.8693H92.346C92.1765 20.0836 91.8221 19.4981 91.2829 19.1129C90.759 18.7277 90.1581 18.5351 89.4802 18.5351C88.679 18.5351 88.0165 18.7431 87.4926 19.1591C86.9688 19.5597 86.6221 20.1298 86.4526 20.8693Z" fill="#384161" />
                <path d="M100.737 24.6827H107.554V27.7333H97.5472V11.5556H107.439V14.6062H100.737V18.0498H106.861V21.0542H100.737V24.6827Z" fill="#5DA4D4" />
                <path d="M118.198 16.1778H121.179V27.7333H118.198V26.3698C117.304 27.4945 116.048 28.0569 114.431 28.0569C112.89 28.0569 111.565 27.4714 110.455 26.3004C109.362 25.1141 108.815 23.6658 108.815 21.9556C108.815 20.2453 109.362 18.8047 110.455 17.6338C111.565 16.4474 112.89 15.8542 114.431 15.8542C116.048 15.8542 117.304 16.4166 118.198 17.5413V16.1778ZM112.697 24.3129C113.298 24.9138 114.061 25.2142 114.985 25.2142C115.91 25.2142 116.672 24.9138 117.273 24.3129C117.89 23.6966 118.198 22.9108 118.198 21.9556C118.198 21.0003 117.89 20.2222 117.273 19.6213C116.672 19.005 115.91 18.6969 114.985 18.6969C114.061 18.6969 113.298 19.005 112.697 19.6213C112.096 20.2222 111.796 21.0003 111.796 21.9556C111.796 22.9108 112.096 23.6966 112.697 24.3129Z" fill="#5DA4D4" />
                <path d="M126.542 19.4596C126.542 19.7677 126.743 20.0219 127.143 20.2222C127.559 20.4071 128.06 20.5766 128.646 20.7307C129.231 20.8693 129.817 21.0542 130.402 21.2853C130.987 21.501 131.481 21.8708 131.881 22.3947C132.297 22.9185 132.505 23.5733 132.505 24.3591C132.505 25.5455 132.058 26.4622 131.165 27.1093C130.286 27.741 129.185 28.0569 127.86 28.0569C125.487 28.0569 123.869 27.1402 123.006 25.3067L125.595 23.8507C125.934 24.8522 126.689 25.3529 127.86 25.3529C128.923 25.3529 129.454 25.0216 129.454 24.3591C129.454 24.051 129.246 23.8044 128.83 23.6196C128.43 23.4193 127.937 23.2421 127.351 23.088C126.766 22.9339 126.18 22.7413 125.595 22.5102C125.009 22.2791 124.509 21.917 124.093 21.424C123.692 20.9156 123.492 20.2839 123.492 19.5289C123.492 18.3887 123.908 17.4951 124.74 16.848C125.587 16.1855 126.635 15.8542 127.883 15.8542C128.823 15.8542 129.678 16.0699 130.448 16.5013C131.219 16.9173 131.827 17.5182 132.274 18.304L129.732 19.6907C129.362 18.9049 128.746 18.512 127.883 18.512C127.498 18.512 127.174 18.5967 126.912 18.7662C126.666 18.9357 126.542 19.1668 126.542 19.4596Z" fill="#5DA4D4" />
                <path d="M136.784 23.1804C137.184 24.6287 138.27 25.3529 140.042 25.3529C141.182 25.3529 142.045 24.9677 142.631 24.1973L145.034 25.584C143.894 27.2326 142.215 28.0569 139.996 28.0569C138.085 28.0569 136.552 27.4791 135.397 26.3236C134.241 25.168 133.664 23.712 133.664 21.9556C133.664 20.2145 134.234 18.7662 135.374 17.6107C136.514 16.4397 137.978 15.8542 139.765 15.8542C141.46 15.8542 142.854 16.4397 143.948 17.6107C145.057 18.7816 145.612 20.2299 145.612 21.9556C145.612 22.3407 145.573 22.749 145.496 23.1804H136.784ZM136.737 20.8693H142.631C142.461 20.0836 142.107 19.4981 141.568 19.1129C141.044 18.7277 140.443 18.5351 139.765 18.5351C138.964 18.5351 138.301 18.7431 137.777 19.1591C137.253 19.5597 136.907 20.1298 136.737 20.8693Z" fill="#5DA4D4" />
                <path d="M14.3 24.3691C19.9412 24.3691 24.5143 19.8285 24.5143 14.2274C24.5143 8.6263 19.9412 4.08571 14.3 4.08571C8.6588 4.08571 4.08571 8.6263 4.08571 14.2274C4.08571 19.8285 8.6588 24.3691 14.3 24.3691Z" fill="white" />
                <path d="M10.7058 26.5042C9.63588 26.5042 8.98377 27.6728 9.55111 28.5734L13.1453 34.2791C13.6788 35.126 14.9212 35.126 15.4547 34.2791L19.0489 28.5734C19.6162 27.6728 18.9641 26.5042 17.8942 26.5042H10.7058Z" fill="white" />
                <path fill-rule="evenodd" clip-rule="evenodd" d="M17.8942 26.5146C18.5781 26.5146 19.0913 26.9928 19.2244 27.5735C19.2995 27.9012 19.2536 28.2616 19.0489 28.587L15.4547 34.3012C14.9212 35.1493 13.6788 35.1493 13.1454 34.3012L9.55112 28.587C9.34643 28.2616 9.30048 27.9012 9.37561 27.5735C9.50871 26.9928 10.0219 26.5146 10.7058 26.5146H17.8942ZM5.75004 25.6186C2.25964 23.0258 0 18.8851 0 14.2195C0 6.3663 6.40233 0 14.3 0C22.1977 0 28.6 6.3663 28.6 14.2195C28.6 18.885 26.3404 23.0258 22.85 25.6186C23.5686 27.1767 23.5618 29.0737 22.5128 30.7414L18.9186 36.4555C16.7847 39.8482 11.8153 39.8481 9.6814 36.4555L6.08716 30.7414C5.0382 29.0737 5.03139 27.1767 5.75004 25.6186ZM8.80562 22.7832C9.3999 23.161 10.0361 23.4793 10.7058 23.7297C11.8238 24.1477 13.035 24.3763 14.3 24.3763C15.565 24.3763 16.7762 24.1477 17.8942 23.7297C18.5639 23.4793 19.2001 23.161 19.7944 22.7832C22.6326 20.9789 24.5143 17.8177 24.5143 14.2195C24.5143 8.61008 19.9412 4.06272 14.3 4.06272C8.65881 4.06272 4.08571 8.61008 4.08571 14.2195C4.08571 17.8177 5.96738 20.9789 8.80562 22.7832Z" fill="#384161" />
                <path d="M6.51218 15.1849C5.76277 14.3369 5.76277 13.0634 6.51218 12.2155L9.15429 9.22596C9.7469 8.55542 10.5988 8.17142 11.4937 8.17142H12.0927C12.6067 8.17142 13.096 8.39197 13.4363 8.77708V8.77708C14.0357 9.45525 14.0357 10.4738 13.4363 11.1519L9.87203 15.1849C8.97966 16.1946 7.40455 16.1946 6.51218 15.1849V15.1849Z" fill="#5EA4D5" />
                <path fill-rule="evenodd" clip-rule="evenodd" d="M18.9978 20.5594C18.3542 21.2029 17.309 21.197 16.6728 20.5461L10.6078 14.3415C9.98177 13.7011 9.9876 12.6761 10.6209 12.0428V12.0428C11.2644 11.3993 12.3097 11.4052 12.9459 12.0561L19.0108 18.2607C19.6368 18.9012 19.631 19.9261 18.9978 20.5594V20.5594Z" fill="#5EA4D5" />
                <path d="M21.8242 11.6492C21.9185 12.1834 21.8824 12.7324 21.719 13.2496C21.5557 13.7668 21.2699 14.237 20.8859 14.6201C20.5019 15.0032 20.0311 15.2879 19.5134 15.45C18.9958 15.6121 18.4467 15.6469 17.9128 15.5513C17.5554 15.4874 17.2425 15.5584 17.06 15.743L11.9655 20.7636C11.6933 21.0246 11.33 21.169 10.9529 21.1658C10.5758 21.1627 10.2149 21.0123 9.94714 20.7468C9.67938 20.4813 9.52596 20.1217 9.51963 19.7447C9.5133 19.3677 9.65455 19.0031 9.91325 18.7288L15.0072 13.7081C15.1897 13.524 15.2586 13.21 15.1921 12.8537C15.0922 12.3206 15.1224 11.7714 15.2801 11.2525C15.4379 10.7336 15.7185 10.2605 16.0983 9.87332C16.478 9.48613 16.9455 9.19631 17.4612 9.02848C17.9769 8.86065 18.5255 8.81977 19.0604 8.90931C19.2158 8.93325 19.3605 9.00344 19.4754 9.11076C19.5904 9.21807 19.6704 9.35752 19.705 9.51095C19.7706 9.79348 19.6866 10.1044 19.4639 10.329L18.1372 11.6675C18.119 11.6868 18.1089 11.7123 18.109 11.7388C18.1091 11.7654 18.1194 11.7908 18.1378 11.8099L18.931 12.5963C18.9502 12.6146 18.9758 12.6247 19.0023 12.6246C19.0288 12.6245 19.0543 12.6141 19.0734 12.5957L20.4006 11.2583C20.5047 11.1516 20.6341 11.0729 20.7767 11.0295C20.9194 10.9861 21.0707 10.9795 21.2166 11.0102C21.5101 11.0755 21.7625 11.3017 21.8242 11.6492Z" fill="#5EA4D5" />
              </svg>
            </SheetTitle>
          </SheetHeader>
          <ScrollArea className="flex-1 py-2 h-[calc(100vh-4rem)]">
            <SidebarNavLinks isExpanded={true} />
          </ScrollArea>
        </SheetContent>
      </Sheet>
    </>
  );
}
